# TemplateFiller

## Technlogies
  - .NET MAUI
  - FreeSpyre.Doc

## Разворачивание приложения
  - Потребуется Visual Studio 2022 v.17.3.0 или новее с установленной нагрузкой ".NET Multiplatform App UI development"
  - Целевая платформа -  Windows 11 21H2. Минимальная - Windows 10 2004. (Работа приложения проверялась на целевой платформе)
  - Шаги для запуска
      - Склонировать репозиторий
      - Открыть решение в Visual Studio
      - Выбрать Build -> Deploy solution
      - Приложение появится в стартовом меню под именем "TemplateFiller.Maui"

## Использование приложения

### Формат шаблонов

  1. Для шаблонов используются файлы формата .docx
  2. Ограничение бесплатной библиотеки FreeSpire.Doc - не более 500 абзацев в документе.
  3. Ниже можно увидеть пример шаблона 

          Меня зовут <<Name; Имя>>.
          Мой день рождения <<Birthday; Дата рождения>>.
          Я оценил <<MoviesCount; Сколько фильмов оценено>> фильмов.

          С уважением,
          <<Name;>>

  4. Для задания поля в шаблоне используется синтаксис вида `<<%идентификатор%;%семантика_поля%>>`.
  5. Семантику необходимо задавать один раз для одного идентификатора.

### Заполнение шаблона

  1. После запуска программы нажать кнопку "Open template"
  2. В появившемся окне выбрать файл с расширением .docx
  3. Заполнить поля, пояившиеся в окне приложения
  4. Нажать кнопку "Save document"
  5. Заполненный документ будет сохранен в той же папке, что и шаблон с добавлением текущих даты и времени в UTC, о чем пользователя уведомит модальное окно.

### Отправка по email

  1. Повторить действия 1-3 в сценарии заполнения шаблона.
  2. Нажать кнопку "Send Email"
  3. Файл сохранится по тому же принципу, что и в случае заполнения шаблона.
  4. После этого откроется проводник с выбранным файлом, а также почтовый клиент по умолчанию с окном создания нового письма.

  > .NET MAUI поддерживает выделенное API для работы с почтовыми клиентами, однако приложения, работающие с WinUI на данный момент не реализуют это API, как это было сделано с UWP в классе `EmailManager`. [Issue на GitHub](https://github.com/microsoft/microsoft-ui-xaml/issues/7300)  
  > Создание [UWP службы приложений](https://docs.microsoft.com/en-us/windows/uwp/launch-resume/how-to-create-and-consume-an-app-service) тоже не решает проблему. Поэтому работа с функциональностью Email выполнена через проводник и ссылку вида `mailto:`